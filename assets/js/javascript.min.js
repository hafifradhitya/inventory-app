function formatRupiah(angka){
    var number_string = angka.toString().replace(/[^,\d]/g, '').toString(),
            split = number_string.split(','),
            sisa  = split[0].length % 3,
            rupiah = split[0].substr(0, sisa),
            ribuan = split[0].substr(sisa).match(/\d{3}/gi);
    if(ribuan){
        separator = sisa ? '.' : '';
        rupiah += separator + ribuan.join('.');
    }
    
    rupiah = split[1] !== undefined ? rupiah + ',' + split[1] : rupiah;
    return rupiah ? rupiah : '';
}

$(document).ready(function(){
    $('.autonumeric').each(function(){
        let field = $(this);
        new AutoNumeric('#'+field.attr('id'), {
           decimalPlaces : 0,
           unformatOnSubmit : true,
           currencySymbol : '',
           decimalCharacter : ',',
           digitGroupSeparator : '.'
       });
    });
    $('.table-data').each(function(){
        $(this).DataTable();
    });
    $('.form-ajax').each(function(){
        $(this).bind('submit',function(e){
            e.preventDefault();
            let form = $(this);
            $.ajax({
                url:form.prop('action'),
                data:new FormData(this),
                cache:false,
                async:false,
                type:'post',
                contentType:false,
                processData:false,
                success:function(data){
                    if(data.error){
                        Swal.fire({
                            icon:'error',
                            html:data.message,
                            timer:1500,
                            showConfirmButton:false
                        });
                    }else{
                        
                        document.location = data.url;
                    }
                }
            });
        });
    });
    
    //if ($('.btn-delete').length>0){
        $(document).on('click', '.btn-delete', function(){
            let btn = $(this);
            Swal.fire({
               icon:'warning',
               text:'Data yang sudah di hapus tidak dapat dikembalikan!',
               title:'Apakah Anda yakin ingin menghapus data ini?',
               showCancelButton: true,
               confirmButtonColor:'#D33',
               confirmButtonText:'Yakin hapus?',
               cancelButtonText:'Batal'     
            }).then((result)=>{
                if (result.isConfirmed){
                    $.ajax({
                       url:btn.data('url') ,
                       data:'id='+btn.data('id'),
                       type:'post',
                       datatype:'text',
                       success:function(data){
                           if(data.error){
                               Swal.fire({
                                   icon:'error',
                                   title:data.pesan,
                                   timer:1500,
                                   showConfirmButton:false
                               });
                           }else{
                               document.location = btn.data('redirect');
                           }
                       }
                    });
                }

            });
        });
    //}
});

